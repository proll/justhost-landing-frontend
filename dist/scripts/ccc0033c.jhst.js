this.jhst=this.jhst||{},this.jhst.Templates=this.jhst.Templates||{},this.jhst.Templates.ptemplates=this.jhst.Templates.ptemplates||{},this.jhst.Templates.ptemplates["pages/403-page"]=Handlebars.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<p class="error-page__description">',g={hash:{},data:e},h+=j((f=c._||b._,f?f.call(b,"phr001","p403",g):i.call(b,"_","phr001","p403",g)))+"</p>"}),this.jhst.Templates.ptemplates["pages/404-page"]=Handlebars.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<ul class="error-page__list">\n	<li class="error-page__list-item">',g={hash:{},data:e},h+=j((f=c._||b._,f?f.call(b,"Make sure that URL entered correctly;","p404",g):i.call(b,"_","Make sure that URL entered correctly;","p404",g)))+'</li>\n	<li class="error-page__list-item">',g={hash:{},data:e},h+=j((f=c._||b._,f?f.call(b,'or drop us a line to <a href="mailto:support@jhstoq.me" class="lnk">support@jhstoq.me.</a>',"p404",g):i.call(b,"_",'or drop us a line to <a href="mailto:support@jhstoq.me" class="lnk">support@jhstoq.me.</a>',"p404",g)))+"</li>\n</ul>"}),this.jhst.Templates.ptemplates["pages/landing-page"]=Handlebars.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<section class="landing-section landing-section1">\n	<div class="landing__container">\n		<div class="landing__container-in">\n			<h1 class="landing__h1">',g={hash:{},data:e},h+=j((f=c._||b._,f?f.call(b,"Get payments online<br/>for what ever and where ever you want","landing_page",g):i.call(b,"_","Get payments online<br/>for what ever and where ever you want","landing_page",g)))+'</h1>\n			<p class="landing-section1-p">',g={hash:{},data:e},h+=j((f=c._||b._,f?f.call(b,"section1-p","landing_page",g):i.call(b,"_","section1-p","landing_page",g)))+'</p>\n			<div class="landing__start">\n				<a href="/auth" class="landing__start-a" rel="nofollow">',g={hash:{},data:e},h+=j((f=c._||b._,f?f.call(b,"Start","landing_page",g):i.call(b,"_","Start","landing_page",g)))+'</a>\n\n				<div class="landing__start-example">\n					<i class="ib ib-pt"></i><a href="http://s.jhstoq.me/b877" target="_blank" class="landing__start-example-a">',g={hash:{},data:e},h+=j((f=c._||b._,f?f.call(b,"Pricetag example","landing_page",g):i.call(b,"_","Pricetag example","landing_page",g)))+'</a>\n				</div>\n			</div>\n\n		</div>\n	</div>\n	<a href="/next" class="landing__next-a" rel="nofollow">\n		<span class="landing__next-title">',g={hash:{},data:e},h+=j((f=c._||b._,f?f.call(b,"How does it work","landing_page",g):i.call(b,"_","How does it work","landing_page",g)))+'</span>\n		<i class="ib ib-arr"></i>\n	</a>\n</section>\n<section class="landing-section landing-section2">\n	<div class="landing__container">\n		<div class="landing__container-in">\n			<h2 class="landing-s-h">',g={hash:{},data:e},h+=j((f=c._||b._,f?f.call(b,"How does Justhost work","landing_page",g):i.call(b,"_","How does Justhost work","landing_page",g)))+'</h2>\n			<ul class="landing__list">\n				<li class="landing__list-itm">\n					<i class="ib ib-l1"></i>\n					<h3 class="landing__list-itm-h">',g={hash:{},data:e},h+=j((f=c._||b._,f?f.call(b,"Connect your payment systems","landing_page",g):i.call(b,"_","Connect your payment systems","landing_page",g)))+'</h3>\n					<p class="landing__list-itm-p">',g={hash:{},data:e},h+=j((f=c._||b._,f?f.call(b,"section2-0-1-p","landing_page",g):i.call(b,"_","section2-0-1-p","landing_page",g)))+'</p>\n				</li>\n				<li class="landing__list-itm">\n					<i class="ib ib-l2"></i>\n					<h3 class="landing__list-itm-h">',g={hash:{},data:e},h+=j((f=c._||b._,f?f.call(b,"Create a price tag","landing_page",g):i.call(b,"_","Create a price tag","landing_page",g)))+'</h3>\n					<p class="landing__list-itm-p">',g={hash:{},data:e},h+=j((f=c._||b._,f?f.call(b,"section2-1-1-p","landing_page",g):i.call(b,"_","section2-1-1-p","landing_page",g)))+'</p>\n				</li>\n				<li class="landing__list-itm">\n					<i class="ib ib-l3"></i>\n					<h3 class="landing__list-itm-h">',g={hash:{},data:e},h+=j((f=c._||b._,f?f.call(b,"Publish the link","landing_page",g):i.call(b,"_","Publish the link","landing_page",g)))+'</h3>\n					<p class="landing__list-itm-p">',g={hash:{},data:e},h+=j((f=c._||b._,f?f.call(b,"section2-2-1-p","landing_page",g):i.call(b,"_","section2-2-1-p","landing_page",g)))+'</p>\n				</li>\n			</ul>\n		</div>\n	</div>\n</section>\n<section class="landing-section landing-section3">\n	<div class="landing__container">\n		<div class="landing__container-in">\n			<h2 class="landing-s-h">',g={hash:{},data:e},h+=j((f=c._||b._,f?f.call(b,"Get payments in any cases","landing_page",g):i.call(b,"_","Get payments in any cases","landing_page",g)))+'</h2>\n			<p class="landing-section3-p">',g={hash:{},data:e},h+=j((f=c._||b._,f?f.call(b,"section3-p","landing_page",g):i.call(b,"_","section3-p","landing_page",g)))+'</p>\n			<ul class="landing__list">\n				<li class="landing__list-itm">\n					<i class="ib ib-li1"></i>\n					<h3 class="landing__list-itm-h">',g={hash:{},data:e},h+=j((f=c._||b._,f?f.call(b,"Donate","landing_page",g):i.call(b,"_","Donate","landing_page",g)))+'</h3>\n					<p class="landing__list-itm-p">',g={hash:{},data:e},h+=j((f=c._||b._,f?f.call(b,"section3-1-1-p","landing_page",g):i.call(b,"_","section3-1-1-p","landing_page",g)))+'</p>\n				</li>\n				<li class="landing__list-itm">\n					<i class="ib ib-li2"></i>\n					<h3 class="landing__list-itm-h">',g={hash:{},data:e},h+=j((f=c._||b._,f?f.call(b,"Payments for digital content","landing_page",g):i.call(b,"_","Payments for digital content","landing_page",g)))+'</h3>\n					<p class="landing__list-itm-p">',g={hash:{},data:e},h+=j((f=c._||b._,f?f.call(b,"section3-2-1-p","landing_page",g):i.call(b,"_","section3-2-1-p","landing_page",g)))+'</p>\n				</li>\n				<li class="landing__list-itm">\n					<i class="ib ib-li3"></i>\n					<h3 class="landing__list-itm-h">',g={hash:{},data:e},h+=j((f=c._||b._,f?f.call(b,"Selling reallife goods","landing_page",g):i.call(b,"_","Selling reallife goods","landing_page",g)))+'</h3>\n					<p class="landing__list-itm-p">',g={hash:{},data:e},h+=j((f=c._||b._,f?f.call(b,"section3-3-1-p","landing_page",g):i.call(b,"_","section3-3-1-p","landing_page",g)))+'</p>\n				</li>\n				<li class="landing__list-itm">\n					<i class="ib ib-li4"></i>\n					<h3 class="landing__list-itm-h">',g={hash:{},data:e},h+=j((f=c._||b._,f?f.call(b,"Freelance and services","landing_page",g):i.call(b,"_","Freelance and services","landing_page",g)))+'</h3>\n					<p class="landing__list-itm-p">',g={hash:{},data:e},h+=j((f=c._||b._,f?f.call(b,"section3-4-1-p","landing_page",g):i.call(b,"_","section3-4-1-p","landing_page",g)))+'</p>\n				</li>\n				<li class="landing__list-itm">\n					<i class="ib ib-li5"></i>\n					<h3 class="landing__list-itm-h">',g={hash:{},data:e},h+=j((f=c._||b._,f?f.call(b,"Group buying","landing_page",g):i.call(b,"_","Group buying","landing_page",g)))+'</h3>\n					<p class="landing__list-itm-p">',g={hash:{},data:e},h+=j((f=c._||b._,f?f.call(b,"section3-5-1-p","landing_page",g):i.call(b,"_","section3-5-1-p","landing_page",g)))+'</p>\n				</li>\n				<li class="landing__list-itm">\n					<i class="ib ib-li6"></i>\n					<h3 class="landing__list-itm-h">',g={hash:{},data:e},h+=j((f=c._||b._,f?f.call(b,"Charity","landing_page",g):i.call(b,"_","Charity","landing_page",g)))+'</h3>\n					<p class="landing__list-itm-p">',g={hash:{},data:e},h+=j((f=c._||b._,f?f.call(b,"section3-6-1-p","landing_page",g):i.call(b,"_","section3-6-1-p","landing_page",g)))+'</p>\n				</li>\n				<li class="landing__list-itm">\n					<i class="ib ib-li7"></i>\n					<h3 class="landing__list-itm-h">',g={hash:{},data:e},h+=j((f=c._||b._,f?f.call(b,"E-learning and consultations","landing_page",g):i.call(b,"_","E-learning and consultations","landing_page",g)))+'</h3>\n					<p class="landing__list-itm-p">',g={hash:{},data:e},h+=j((f=c._||b._,f?f.call(b,"section3-7-1-p","landing_page",g):i.call(b,"_","section3-7-1-p","landing_page",g)))+'</p>\n				</li>\n				<li class="landing__list-itm">\n					<i class="ib ib-li8"></i>\n					<h3 class="landing__list-itm-h">',g={hash:{},data:e},h+=j((f=c._||b._,f?f.call(b,"And much more","landing_page",g):i.call(b,"_","And much more","landing_page",g)))+'</h3>\n					<p class="landing__list-itm-p">',g={hash:{},data:e},h+=j((f=c._||b._,f?f.call(b,"section3-8-1-p","landing_page",g):i.call(b,"_","section3-8-1-p","landing_page",g)))+'</p>\n				</li>\n			</ul>\n		</div>\n	</div>\n</section>\n<section class="landing-section landing-section4">\n	<div class="landing__container">\n		<div class="landing__container-in">\n			<ul class="landing__list">\n				<li class="landing__list-itm">\n					<h3 class="landing__list-itm-h">',g={hash:{},data:e},h+=j((f=c._||b._,f?f.call(b,"Fast","landing_page",g):i.call(b,"_","Fast","landing_page",g)))+'</h3>\n					<i class="ib ib-l4_1"></i>\n					<p class="landing__list-itm-p">',g={hash:{},data:e},h+=j((f=c._||b._,f?f.call(b,"section4-1-1-p","landing_page",g):i.call(b,"_","section4-1-1-p","landing_page",g)))+'</p>\n				</li>\n				<li class="landing__list-itm">\n					<h3 class="landing__list-itm-h">',g={hash:{},data:e},h+=j((f=c._||b._,f?f.call(b,"Cozy","landing_page",g):i.call(b,"_","Cozy","landing_page",g)))+'</h3>\n					<i class="ib ib-l4_2"></i>\n					<p class="landing__list-itm-p">',g={hash:{},data:e},h+=j((f=c._||b._,f?f.call(b,"section4-2-1-p","landing_page",g):i.call(b,"_","section4-2-1-p","landing_page",g)))+'</p>\n				</li>\n				<li class="landing__list-itm">\n					<h3 class="landing__list-itm-h">',g={hash:{},data:e},h+=j((f=c._||b._,f?f.call(b,"Free","landing_page",g):i.call(b,"_","Free","landing_page",g)))+'</h3>\n					<i class="ib ib-l4_3"></i>\n					<p class="landing__list-itm-p">',g={hash:{},data:e},h+=j((f=c._||b._,f?f.call(b,"section4-3-1-p","landing_page",g):i.call(b,"_","section4-3-1-p","landing_page",g)))+'</p>\n				</li>\n			</ul>\n			<div class="landing__start-cont"><a href="/auth" rel="nofollow" class="landing__start-a">',g={hash:{},data:e},h+=j((f=c._||b._,f?f.call(b,"Start Justhost","landing_page",g):i.call(b,"_","Start Justhost","landing_page",g)))+"</a></div>\n		</div>\n	</div>\n</section>"}),this.jhst.Templates.ptemplates["popups/auth"]=Handlebars.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="auth__cont">\n	<div class="auth__social">\n		<h2 class="auth__social-h">',g={hash:{},data:e},h+=j((f=c._||b._,f?f.call(b,"Social log in","auth",g):i.call(b,"_","Social log in","auth",g)))+'</h2>\n		<ul class="auth__social-list">\n			<li class="auth__social-item"><a href="vk" rel="nofollow" class="auth__social-item-lnk auth__social-item-lnk_vk"><i class="qi qi-share-vk auth__social-item-icn"></i></a></li><li class="auth__social-item"><a href="fb" rel="nofollow" class="auth__social-item-lnk auth__social-item-lnk_fb"><i class="qi qi-share-fb auth__social-item-icn"></i></a></li>\n		</ul>\n	</div>\n	<div class="auth__sign">\n		<span class="auth__sign-toggler">',g={hash:{},data:e},h+=j((f=c._||b._,f?f.call(b,"or","auth",g):i.call(b,"_","or","auth",g)))+' <a href="signup" rel="nofollow" class="auth__sign-toggler-lnk auth__sign-toggler_signup">',g={hash:{},data:e},h+=j((f=c._||b._,f?f.call(b,"sign up","auth",g):i.call(b,"_","sign up","auth",g)))+'</a>\n		<a href="signin" rel="nofollow" class="auth__sign-toggler-lnk auth__sign-toggler_signin">',g={hash:{},data:e},h+=j((f=c._||b._,f?f.call(b,"log in by e-mail","auth",g):i.call(b,"_","log in by e-mail","auth",g)))+'</a>\n		</span>\n		<h2 class="auth__sign-h auth__sign-h_signin">',g={hash:{},data:e},h+=j((f=c._||b._,f?f.call(b,"Log in by e-mail","auth",g):i.call(b,"_","Log in by e-mail","auth",g)))+'</h2>\n		<h2 class="auth__sign-h auth__sign-h_signup">',g={hash:{},data:e},h+=j((f=c._||b._,f?f.call(b,"Sign up","auth",g):i.call(b,"_","Sign up","auth",g)))+'</h2>\n		<h2 class="auth__sign-h auth__sign-h_emailconfirm">',g={hash:{},data:e},h+=j((f=c._||b._,f?f.call(b,"Enter your e-mail","auth",g):i.call(b,"_","Enter your e-mail","auth",g)))+'</h2>\n		<form action="/auth" class="auth__sign-form">\n			<div class="jhst__inp-group">\n				<div class="jhst__inp-cont">\n					<label>\n						<span class="jhst__lbl">',g={hash:{},data:e},h+=j((f=c._||b._,f?f.call(b,"e-mail","auth",g):i.call(b,"_","e-mail","auth",g)))+'</span>\n						<div class="jhst__inp-cont-in">\n							<input maxlength="50" type="text" class="jhst__inp" name="login" value="">\n						</div>\n					</label>\n				</div>\n				<div class="jhst__inp-cont auth__sign-inp-name-cont">\n					<label>\n						<span class="jhst__lbl">',g={hash:{},data:e},h+=j((f=c._||b._,f?f.call(b,"name","auth",g):i.call(b,"_","name","auth",g)))+'</span>\n						<div class="jhst__inp-cont-in">\n							<input maxlength="55" type="text" class="jhst__inp" name="fio" value="">\n						</div>\n					</label>\n				</div>\n				<div class="jhst__inp-cont auth__sign-inp-password-cont">\n					<label>\n						<span class="jhst__lbl">',g={hash:{},data:e},h+=j((f=c._||b._,f?f.call(b,"password","auth",g):i.call(b,"_","password","auth",g)))+'</span>\n						<div class="jhst__inp-cont-in">\n							<input maxlength="45" type="password" class="jhst__inp" name="password" value="">\n						</div>\n					</label>\n				</div>\n			</div>\n			<div class="auth__sign-user-agreement">\n				',g={hash:{},data:e},h+=j((f=c._||b._,f?f.call(b,'I admit <a href="/i/user-agreement/">user agreement</a>',"auth",g):i.call(b,"_",'I admit <a href="/i/user-agreement/">user agreement</a>',"auth",g)))+'\n			</div>\n			<input type="submit" class="auth__sign-submit-hidden">\n			<div class="auth__sign-submit">\n				<span class="auth__sign-submit-error"></span>\n				<a href="signin" rel="nofollow" class="auth__sign-submit-a auth__sign-submit_signin">',g={hash:{},data:e},h+=j((f=c._||b._,f?f.call(b,"Log in","auth",g):i.call(b,"_","Log in","auth",g)))+'</a><a href="signup" rel="nofollow" class="auth__sign-submit-a auth__sign-submit_signup">',g={hash:{},data:e},h+=j((f=c._||b._,f?f.call(b,"Sign up","auth",g):i.call(b,"_","Sign up","auth",g)))+'</a><a href="emailconfirm" rel="nofollow" class="auth__sign-submit-a auth__sign-submit_emailconfirm">',g={hash:{},data:e},h+=j((f=c._||b._,f?f.call(b,"Log in","auth",g):i.call(b,"_","Log in","auth",g)))+"</a>\n			</div>\n		</form>\n	</div>\n</div>"}),this.jhst.Templates.ptemplates["popups/confirm"]=Handlebars.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g="",h="function",i=this.escapeExpression;return g+='<p class="confirm__p">',(f=c.content)?f=f.call(b,{hash:{},data:e}):(f=b.content,f=typeof f===h?f.apply(b):f),g+=i(f)+'</p>\n<ul class="confirm__line">\n	<li class="confirm__ok">',(f=c.ok_title)?f=f.call(b,{hash:{},data:e}):(f=b.ok_title,f=typeof f===h?f.apply(b):f),g+=i(f)+'</li>\n	<li class="confirm__close">',(f=c.close_title)?f=f.call(b,{hash:{},data:e}):(f=b.close_title,f=typeof f===h?f.apply(b):f),g+=i(f)+'</li>\n</ul>\n<p class="confirm__p_success">',(f=c.success_title)?f=f.call(b,{hash:{},data:e}):(f=b.success_title,f=typeof f===h?f.apply(b):f),g+=i(f)+'</p>\n<p class="confirm__p_error">',(f=c.error_title)?f=f.call(b,{hash:{},data:e}):(f=b.error_title,f=typeof f===h?f.apply(b):f),g+=i(f)+"</p>"}),this.jhst.Templates.ptemplates["popups/popup"]=Handlebars.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g="",h="function",i=this.escapeExpression;return g+='<table class="popup__table ',(f=c.klass)?f=f.call(b,{hash:{},data:e}):(f=b.klass,f=typeof f===h?f.apply(b):f),g+=i(f)+'" tabindex="-1">\n	<tr>\n		<td class="popup__td">\n			<div class="popup__close">\n				<div class="popup__close-col">\n					<span class="close">&times;</span>\n				</div>\n			</div>\n			<div class="popup__previous">\n				<div class="popup__previous-col">\n					<i class="prev"></i>\n				</div>\n			</div>\n			<div class="popup__inner">\n				<div class="popup__content">\n					<i class="qi qi-popup-close popup__close-btn"></i>\n					',(f=c.content)?f=f.call(b,{hash:{},data:e}):(f=b.content,f=typeof f===h?f.apply(b):f),(f||0===f)&&(g+=f),g+="\n				</div>\n			</div>\n		</td>\n	</tr>\n</table>"}),this.jhst.Templates.ptemplates["popups/warning"]=Handlebars.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h,i="",j=c.helperMissing,k=this.escapeExpression,l="function";return i+='<h1 class="warning__h">',h={hash:{},data:e},i+=k((f=c._||b._,f?f.call(b,"Warning!","warning",h):j.call(b,"_","Warning!","warning",h)))+'</h1>\n<p class="warning__p">',(g=c.content)?g=g.call(b,{hash:{},data:e}):(g=b.content,g=typeof g===l?g.apply(b):g),(g||0===g)&&(i+=g),i+='</p>\n<span class="warning__close">',h={hash:{},data:e},i+=k((f=c._||b._,f?f.call(b,"Ok","warning",h):j.call(b,"_","Ok","warning",h)))+"</span>"}),"undefined"==typeof console&&(this.console={log:function(){},error:function(){}}),_.browser.chrome&&["log","warn"].forEach(function(a){var b=console[a];console[a]=function(){var a=(new Error).stack.split(/\n/);0===a[0].indexOf("Error")&&(a=a.slice(1));var c=[].slice.apply(arguments).concat([a[1].trim()]);return b.apply(console,c)}}),window.jhst=window.jhst||{},window.jhst=_.extend(window.jhst,{language:_.getCookie("lang")||"ru",root:"http://jhstoq.me",l10n:{},preloadTemplates:function(){if(window.jhst_dev){var a=[];return _.each(window.templates.files,function(b){var c=window.templates.path+"/"+b+"."+window.templates.ext;a.push($.get(c,function(a){jhst.Templates.add(b,a)}))}),a}return[]},init:function(){"en"!==this.language&&"ru"!==this.language&&(this.language="en"),$.when.apply(this,this.preloadTemplates()).done(function(){jhst.app=new jhst.App({debug:!0}),Backbone.history.start({pushState:!0})}),$(document).on("click","a",function(a){if(a.metaKey||a.ctrlKey)return!0;var b=$(this);return b.attr("target")||-1!==b.attr("href").indexOf("mailto:")?!0:(a.stopPropagation(),a.preventDefault(),"event"==b.attr("type")?jhst.trigger(b.attr("href")):(jhst.app.router.context=b.data(),jhst.app.router.navigate(b.attr("href"),{trigger:!0})),!1)})},log:function(a){console.log(a)},error:function(a){console.error(a)},navigate:function(a,b){b&&b.trigger===!1&&(jhst.app.statistic.trackCurrentPageChange(),jhst.app.trigger("need:meta:update")),jhst.app.router.navigate(a,b)},is_needauth:function(){return jhst.is_authed()?!1:(jhst.trigger("auth:show"),!0)},is_authed:function(){return!!jhst.user&&jhst.user.is_auth()},is_authset:function(){return!!jhst.user&&jhst.user.is_authset()},authUrl:function(a){var b={};return jhst.app&&jhst.app.user.get("token")?(b={token:jhst.app.user.get("token")},-1==a.indexOf("?")&&(a+="?"),a+_.map(b,function(a,b){return b+"="+a}).join("&")):a},warning:function(a,b){new jhst.WarningView({content:jhst.localize(a,b)})},localize:function(a,b){return Handlebars.helpers._(a,b).toString()},speedScrollTop:function(a,b){$("html, body").animate({scrollTop:a||0},b||300)},isLink:function(a){return!jhst.isFile(a)},isFile:function(a){return a=a||"",-1!==a.indexOf("jhstoq.me")}}),window.jhst.Templates=window.jhst.Templates||{},window.jhst.Templates=_.extend(window.jhst.Templates,{templates:{},compiled:{},add:function(a,b){this.templates[a]=b},get:function(a){if(window.jhst_dev)return this.compiled[a]?this.templates[a]:this.templates[a]?(this.templates[a]=Handlebars.compile(this.templates[a]),this.compiled[a]=!0,this.templates[a]):(console.error("Can't find template \""+a+'"'),function(){return""});if(this.ptemplates){var b=this.ptemplates[a];return b?b:(console.error("Can't find template \""+a+'"'),function(){return""})}return console.error("Can't find templates at all"),function(){return""}}}),Backbone._sync=Backbone.sync,Backbone.sync=function(a,b,c){c=c||{};var d={};return c.userData?d={token:c.userData.token,lang:jhst.language}:(d={lang:jhst.language},jhst.app&&jhst.app.user.get("uid")&&(d.token=jhst.app.user.get("token"))),c.url=c.url||b.url&&_.result(b,"url"),c.url+=-1===c.url.indexOf("?")?"?":"&",c.url+=_.map(d,function(a,b){return b+"="+a}).join("&"),Backbone._sync(a,b,c)},$(document).ready(function(){_.extend(jhst,Backbone.Events),jhst.init()}),jhst.LazyLoader=Backbone.Model.extend({onImageError:function(){this.trigger("load:error")},load:function(a){var b=a.find("img.lazy"),c=this;_.forEach(b,function(a){var b=$(a),d=b.data(),e=new Image;e.src=d.orig,e.onload=function(){if(b.parents(".load-bg").toggleClass("img-loaded",!0),d.scale){var a=this.width,c=this.height,e=d.width,f=d.height,g=a/e,h=c/f;b.css(g>h?{width:e,height:"auto"}:{width:"auto",height:f})}if(d.bg){var i={},j="cover",k=0,l=0;if(d.crop){var a=this.width,c=this.height,e=d.width,f=d.height,g=a/e,h=c/f;g>h?(j="cover",k=-Math.round((a/h-e)/2)):h>g&&(j="cover",l=-Math.round((c/g-f)/2)),i={"background-image":"url("+d.orig+")","background-position-x":k,"background-position-y":l,width:e,height:f}}else i={"background-image":"url("+d.orig+")"};b.css(i)}else b.attr("src",d.orig)},e.onerror=_.bind(c.onImageError,c)})}}),jhst.Page=Backbone.Model.extend({initialize:function(a){a.template||this.trigger("error",{message:"Page must have a template"}),this.view=new jhst.PageView({model:this,template:a.template}),this.view.on("render",function(){this.collection.trigger("render")}),this.get("view")&&(this.pageView=this.get("model")?new(jhst[this.get("view")])({model:this.get("model")}):new(jhst[this.get("view")])),this.get("model")&&(this.pageModel=new(jhst[this.get("model")]))},render:function(){this.view&&this.view.render&&this.view.render()},remove:function(){this.view.remove()},enterDocument:function(){}}),jhst.PageView=Backbone.View.extend({el:"#jhst-container",template:"",renderedHtml:null,initialize:function(a){return a&&a.template?(this.template=jhst.Templates.get(a.template),void this.createDom()):void jhst.error("Page must have a template")},createDom:function(){},render:function(){if(this.renderedHtml)this.$el.append(this.renderedHtml);else{var a=$("<div></div>").addClass("page-"+this.model.get("name")).html(this.template(this.model.toJSON()));this.trigger("page:preRender",a),this.$el.html(a)}$("body").attr("class","body__page-"+this.model.get("name")),this.model.enterDocument(),this.trigger("page:render",this.model),this.trigger("enterDocument",this.model)},remove:function(){console.log("page remove"),this.renderedHtml=this.$el.find(".page-"+this.model.get("name")).detach()}}),jhst.PagesCollection=Backbone.Collection.extend({initialize:function(){},getPage:function(a){var b=this.find(function(b){return b.get("name")==a});return b||this.first()},havePage:function(a){return this.any(function(b){return b.get("name")==a})}}),jhst.PopupView=Backbone.View.extend({template:"popups/popup",className:"popup",events:{"click .popup__previous":"previous","click .popup__close":"hide","click .popup__close-btn":"hide","click .popup__td":"bgClick"},options:{},defaults:{content:"",klass:"",width:""},_rendered:!1,initialize:function(){this.template=jhst.Templates.get(this.template),_.defaults(this.options,this.defaults),this.on("popup:show",function(){this.trigger("show")},this),this.on("popup:hide",function(){this.trigger("hide")},this)},render:function(){if(this._rendered)return this.$el;var a=this.options.content;return(_.isObject(a)||!a)&&(this.options.content="<div id='placeholder"+this.cid+"'>"),this.$el.append(this.template(this.options)),this.setContent(a),this._rendered=!0,this.$el.on("scroll.popup",function(a){var b=$(a.currentTarget),c=b.find(".popup__table");b.scrollTop()+150>=c.height()-b.height()&&jhst.trigger("popupbottom:reached")}),this.$el},lockPage:function(){},unlockPage:function(){},bgClick:function(a){a&&a.target&&"popup__td"==a.target.className&&this.hide()},reactKeypress:function(a){if(27==a.keyCode){var b=$(a.srcElement);b.is(":input")||this.hide()}},showPopup:function(){var a=$(document.body);a.append(this.render()),this.lockPage(),this.trigger("popup:show"),$(document).on("keyup.popup",_.bind(this.reactKeypress,this))},hidePopup:function(){this.$el.off("scroll.popup"),this.$el.detach(),this.trigger("popup:hide"),$(document).off("keyup.popup")},show:function(){this.showPopup()},hide:function(){return this.hidePopup(),this.unlockPage(),!1},previous:function(){this.trigger("previous")},scroll:function(a){this.$el.animate({scrollTop:a},200)},setContent:function(a){a&&(this.options.content=a,this._rendered?this.$el.find(".popup__content").empty().append(a):this.$el.find("#placeholder"+this.cid).replaceWith(a))},setWidth:function(a){a&&(this.options.width=a,this.$el.find(".popup__inner").toggleClass().addClass("popup__inner").addClass("span"+a))}}),jhst.WarningView=Backbone.View.extend({template:"popups/warning",className:"warning",events:{"click .warning__close":"close"},options:{content:":("},initialize:function(a){this.options=a,this.template=jhst.Templates.get(this.template),this.popup_view=new jhst.PopupView({klass:"warning-popup"}),this.popup_view.on("hide",this.clear,this),this.render()},render:function(){return this.$el.append(this.template(this.options)),this.popup_view.setContent(this.$el),this.popup_view.show(),this.$el},close:function(){return this.popup_view.hide(),!1},clear:function(){return this.popup_view.remove(),this.remove(),!1}}),jhst.Confirm=Backbone.Model.extend({url:"/",defaults:{url:"/",data:{},method:"post",event:"",eventdata:"",content:"?",ok_title:"Ok",close_title:"Cancel",success_title:"Allset",error_title:"Something went wrong...",backreload:!1},initialize:function(a){a&&a.url&&(this.url=a.url),this.view=new jhst.ConfirmView({model:this})},fetch:function(a){return a=a||{},a.type=this.get("method"),a.data=this.get("data"),a.success=_.bind(this.success,this),a.error=_.bind(this.error,this),this.trigger("load:start"),Backbone.Model.prototype.fetch.call(this,a)},success:function(a,b){b=_.toJSON(b),b.error?this.trigger("confirm:error"):(this.trigger("confirm:success"),this.get("event")&&(console.log(this.get("event"),this.get("eventdata")),this.get("eventdata")&&!_.isEmpty(_.toJSON(this.get("eventdata")))?jhst.trigger(this.get("event"),_.toJSON(this.get("eventdata"))):jhst.trigger(this.get("event"))))},error:function(){this.trigger("confirm:error")}}),jhst.ConfirmView=Backbone.View.extend({template:"popups/confirm",className:"confirm",events:{"click .confirm__close":"close","click .confirm__ok":"confirm"},initialize:function(){this.template=jhst.Templates.get(this.template),this.popup_view=new jhst.PopupView({klass:"confirm-popup"}),this.model.on("load:start",this.confirmStart,this),this.model.on("confirm:success",this.confirmSuccess,this),this.model.on("confirm:error",this.confirmError,this),this.popup_view.on("hide",this.clear,this),this.render()},render:function(){return this.$el.append(this.template(this.model.toJSON())),this.popup_view.setContent(this.$el),this.popup_view.show(),this.$el},confirm:function(){return this.model.fetch(),!1},confirmStart:function(){return this.$el.toggleClass("confirm_loading",!0).toggleClass("confirm_success",!1).toggleClass("confirm_error",!1),!1},confirmSuccess:function(){if(this.$el.toggleClass("confirm_loading",!1).toggleClass("confirm_success",!0).toggleClass("confirm_error",!1),this.model.get("backreload")){setTimeout(_.bind(function(){jhst.trigger("historyback:reload"),this.clear()},this),1e3)}return!1},confirmError:function(){this.$el.toggleClass("confirm_loading",!1).toggleClass("confirm_success",!1).toggleClass("confirm_error",!0);setTimeout(_.bind(function(){this.$el.toggleClass("confirm_error",!1)},this),2500);return!1},close:function(){return this.popup_view.hide(),!1},clear:function(){return this.popup_view.remove(),this.remove(),this.model.clear({silent:!0}),!1}}),jhst.UserSettings=Backbone.Model.extend({url:"/v1/users/",defaults:{geo_position:null},fetch:function(a){return a=a||{},a.type="get",a.data=a.data||{token:_.getCookie("token")},a.success=_.bind(this.success,this),a.error=_.bind(this.error,this),this.trigger("load:start"),Backbone.Model.prototype.fetch.call(this,a)},success:function(a,b){var b=_.toJSON(b);b.success&&b.result.user?(this.set(b.result.user),this.trigger("usersettings:ready",b.result.user)):this.trigger("error",{description:"WHP/auth : check state ERROR after netcall!"})},error:function(){this.trigger("error",{description:"WHP/auth : check state ERROR self!"})},getGeoPosition:function(){this.get("geo_position")||(navigator.geolocation?navigator.geolocation.getCurrentPosition(_.bind(this.getGeoSuccess,this),_.bind(this.getGeoError,this)):error("not supported"))},getGeoSuccess:function(a){this.set("geo_position",a)},getGeoError:function(a){jhst.error(a)}}),jhst.User=Backbone.Model.extend({cookie_time:365,defaults:{status:"",uid:"",token:""},settings:null,initialize:function(){this.settings=new jhst.UserSettings,this.settings.on("error",function(a){this.trigger("user:error",a)},this),this.on("change:token",function(){this.settings.fetch()},this),this.getSession(),jhst.on("auth:success",this.setSession,this),jhst.on("auth:clear",this.clearSession,this)},getSession:function(){var a=_.getCookie("uid"),b=_.getCookie("token");a&&b&&this.set({uid:a,token:b})},is_auth:function(){return!!this.get("token")},is_authset:function(){return!!this.settings.get("id")},setSession:function(a){_.setCookie("uid",a.session.uid,this.cookie_time),_.setCookie("token",a.session.token,this.cookie_time),this.set(a.session)},clearSession:function(){_.clearCookie("uid"),_.clearCookie("token")}}),jhst.Registration=Backbone.Model.extend({url:"/v1/users/",initialize:function(){},fetch:function(a){if(!this.loading){this.loading=!0;var b=this;this.set(a),$.ajax({type:"POST",url:_.toSafeUrl(this.url),dataType:"json",data:{email:a.login,password:a.password,name:a.name}}).success(function(a,c,d){b.success(a,c,d)}).error(function(a,c,d){b.error(a,c,d)})}},success:function(a){this.loading=!1;var b=_.toJSON(a);b?(this.trigger("auth:success",{response:b.result,user:b.result.user,session:{token:b.result.token,uid:b.result.user.id}}),this.trigger("registration:success")):this.error(null,null,"unknown")},error:function(a,b,c){this.loading=!1,this.trigger("error",{description:c})}}),jhst.Signin=Backbone.Model.extend({url:"/v1/auth",loading:!1,initialize:function(){},login:function(a){return this.loading?void 0:(this.loading=!0,this.fetch(a),!1)},fetch:function(a){var b=this;$.ajax({type:"post",url:this.url,dataType:"json",data:{email:a.login,password:a.password}}).success(function(a,c,d){b.success(a,c,d)}).error(function(a,c,d){b.error(a,c,d)})},success:function(a){this.loading=!1;var b=_.toJSON(a);b?this.trigger("auth:success",{response:b.result,user:b.result.user,session:{token:b.result.token,uid:b.result.user.id}}):this.error(null,null,"unknown")},error:function(a,b,c){if(this.loading=!1,console.log(a,b,c),a.responseText){var d=_.toJSON(a.responseText);if(d&&d.error)return this.trigger("error",d.error),!0}return this.trigger("error",{}),!0}}),jhst.EmailConfirm=Backbone.Model.extend({url:"/v1/users/",inited:!1,defaults:{user_obj:{},email:"@vk.com"},loading:!1,initialize:function(){},fetch:function(a){if(!this.loading){this.loading=!0,this.set({email:a.email});var b=this,c=this.url+this.get("user_obj").user.id+"?token="+this.get("user_obj").session.token+"&lang"+jhst.language;$.ajax({type:"post",url:c,dataType:"json",data:{email:a.email}}).success(function(a,c,d){b.success(a,c,d)}).error(function(a){b.error(a)})}},success:function(a){this.loading=!1;var b=_.toJSON(a);if(b&&b.success){var c=this.get("user_obj");c.user.email=this.get("email"),this.trigger("auth:success",c)}else this.error()},error:function(a,b,c){if(this.loading=!1,console.log(a,b,c),a.responseText){var d=_.toJSON(a.responseText);if(d&&d.error)return this.trigger("error",d.error),!0}return this.trigger("error",{}),!0}}),jhst.TW=Backbone.Model.extend({url_token:"/api/auth/twitter/request_token/",url:"/api/auth/",inited:!1,req_count:0,req_max:5,curWind:null,loading:!1,oauth_token:0,initialize:function(){var a,b=document.getElementsByTagName("script")[0];
document.getElementById("twitter-jssdk")||(a=document.createElement("script"),a.id="twitter-jssdk",$(a).load(function(){}),a.src="//platform.twitter.com/widgets.js",b.parentNode.insertBefore(a,b),this.inited=!0,this.on("error",function(a){console.error(a)},this),jhst.is_authed()||(this.req_count=0,this.fetchToken()))},login:function(){return jhst.log("login tw >"),this.loading||(this.curWind=_.openWindow2("Twitter auth",640,480),this.curWind.location.href="http://api.twitter.com/oauth/authorize?oauth_token="+this.oauth_token),!1},fetchToken:function(){this.req_count>this.req_max&&this.trigger("error",{description:"too many token request to "+this.url_token}),this.loading=!0;var a=this;$.ajax({type:"GET",url:_.toSafeUrl(this.url_token),dataType:"json"}).success(function(b,c,d){a.successToken(b,c,d)}).error(function(b,c,d){a.errorToken(b,c,d)})},successToken:function(a){var b=_.toJSON(a);this.req_count++,b.error?this.trigger("error",{description:"WHP/auth/TW : got error while getting twitter token = ["+b.error.code+"]"}):(this.oauth_token=b.oauth_token,this.loading=!1,jhst.log("WHP/auth/TW : get twitter request token = ["+b.oauth_token+"]"),this.req_count=0)},errorToken:function(a,b){this.req_count++,this.trigger("error",{description:"WHP/auth/TW : error while logging in!"});var b=a.status;console.log(a),0==b?this.trigger("error",{description:"WHP/auth/TW : OFFLINE mode!"}):this.trigger("error",{description:"WHP/auth/TW : error while getting twitter request token! Status = ["+b+"] Tries = ["+this.req_count+"]"}),this.fetchToken()},fetch:function(a){jhst.log("GET TW AUTH = ["+a.uid+" : "+a.token+" : "+a.secret+"]"),jhst.log("WHP/auth/TW : get auth...");var b=this;$.ajax({type:"GET",url:_.toSafeUrl(this.url),dataType:"json",data:{social:"tw",access_token:a.token,access_token_secret:a.secret}}).success(function(a,c,d){b.success(a,c,d)}).error(function(a,c,d){b.error(a,c,d)})},success:function(a){var b=_.toJSON(a);b.error?"API_AuthFailed"==b.error.code?this.trigger("error",{description:"This account isn't linked with WeHeartPics"}):this.trigger("error",{description:"Something went wrong"}):this.trigger("auth:success",{response:b,user:b.user,session:{token:b.user.token,uid:b.user.id}})},error:function(){this.trigger("error",{description:"WHP/auth/TW : error while logging in!"})}}),jhst.VK=Backbone.Model.extend({url:"/v1/auth/vk",inited:!1,wind:null,app_id:3836385,redirect_url:jhst.root+"/go/close_vk.html",loading:!1,initialize:function(){},login:function(){return this.wind=_.openWindow2("VK auth",640,480),this.wind.location.href="http://oauth.vk.com/authorize?client_id="+this.app_id+"&scope=photos,offline&response_type=token&display=popup&redirect_uri="+this.redirect_url,!1},fetch:function(a){var b=this,c=this.url;jhst.is_authed()&&(c=jhst.authUrl(this.url)),$.ajax({type:"post",url:c,dataType:"json",data:{vkAccessToken:a.token,vkUserId:a.uid}}).success(function(a,c,d){b.success(a,c,d)}).error(function(a){b.error(a)})},success:function(a){var b=_.toJSON(a);b&&b.success?this.trigger("auth:success",{response:b.result,user:b.result.user,session:{token:b.result.token,uid:b.result.user.id}}):this.error()},error:function(){jhst.log("auth/VK : error while logging in!"),this.trigger("error",{description:"Something went wrong"})}}),jhst.FB=Backbone.Model.extend({url:"/v1/auth/fb",app_id:"137692866413480",inited:!1,access_token:null,access_uid:null,initialize:function(){$.getScript("//connect.facebook.net/en_US/all.js#xfbml=1",_.bind(function(){FB.init({appId:this.app_id,cookie:!0,status:!0,xfbml:!0,oauth:!1}),FB.Event.subscribe("edge.create",this.fbShareEvents),_.browser.opera&&(FB.XD._transport="postmessage",FB.XD.PostMessage.init()),FB.getLoginStatus(_.bind(function(a){jhst.log(a&&"connected"==a.status?"Facebook : user was succesfully connected! :)":"Facebook : user was not connected! :("),jhst.fbapp&&!jhst.is_authed()&&this.onFBData(a)},this)),this.inited=!0},this))},fetch:function(){if(null!=this.access_token){var a=this,b=this.url;jhst.is_authed()&&(b=jhst.authUrl(this.url)),$.ajax({type:"post",url:b,data:{fbUserId:this.access_uid,fbAccessToken:this.access_token},dataType:"json"}).success(function(b,c,d){a.success(b,c,d)}).error(function(b){a.error(b)})}},success:function(a){var b=_.toJSON(a);b&&b.success?this.trigger("auth:success",{response:b.result,user:b.result.user,session:{token:b.result.token,uid:b.result.user.id}}):this.error()},error:function(){jhst.log("QST/auth/FB : error while logging in!"),this.trigger("error",{description:"QST/auth/FB : error while logging in!"})},login:function(){return this.access_token="",FB.login(_.bind(this.onFBData,this),{scope:"publish_actions,publish_stream,user_photos,offline_access,email"}),!1},loginOG:function(a,b){this.access_token="",FB.login(b,{scope:"publish_actions,publish_stream,user_photos,offline_access,email,user_birthday"})},fbShareEvents:function(a){jhst.log("CreateEdge"),this.trigger("fb:like",a)},onFBData:function(a){if("connected"==a.status){jhst.log("Facebook : user was succesfully connected! :)",a.authResponse);var b=a.authResponse.userID,c=a.authResponse.accessToken;this.access_token!=c?(jhst.log("Facebook : token = ["+c+"]"),this.access_uid=b,this.access_token=c,this.fetch()):jhst.log("Facebook : user was not connected! :(")}}}),jhst.AuthView=Backbone.View.extend({template:"popups/auth",rendered:!1,className:"auth",events:{"click .auth__sign-toggler-lnk":"toggleSign","click .auth__social-item-lnk_vk":"loginVK","click .auth__social-item-lnk_fb":"loginFB",keypress:"hideErrors",click:"hideErrors","submit .auth__sign-form":"submit","click .auth__sign-submit-a":"submitForm"},initialize:function(){this.template=jhst.Templates.get(this.template),this.model.on("auth:show",this.render,this),this.model.on("auth:success",this.remove,this),this.model.on("change:state",this.changeState,this)},render:function(){this.rendered=!0,this.$el.append(this.template(this.model.toJSON())),this.popup_view=new jhst.PopupView({klass:"auth-popup"}),this.popup_view.on("hide",this.remove,this),this.popup_view.setContent(this.$el),this.popup_view.show(),this.$cont=this.$el.find(".auth__cont"),this.$sign_toggler=this.$el.find(".auth__toggler"),this.$form=this.$el.find(".auth__sign-form"),this.$input_email=this.$form.find("input[name=login]"),this.$input_name=this.$form.find("input[name=fio]"),this.$input_password=this.$form.find("input[name=password]"),this.$submit_btn=this.$form.find(".auth__sign-submit-a"),this.$error=this.$form.find(".auth__sign-submit-error"),this.model.signin.on("error",this.errorSignin,this),this.model.registration.on("error",this.errorSignup,this),this.model.emailconfirm.on("error",this.errorEmail,this),this.toggleSign(),this.$input_email.focus()},toggleSign:function(a){a&&(a.preventDefault(),a.stopPropagation()),"signin"===this.model.get("state")?this.model.set("state","signup"):this.model.set("state","signin")},changeState:function(a,b){return this.$input_email.focus(),"signup"===b?(this.$el.toggleClass("signin",!1).toggleClass("signup",!0).toggleClass("emailconfirm",!1),this.$input_email.attr("tabindex",1).attr("autocomplete","off"),this.$input_name.attr("tabindex",2).attr("autocomplete","off"),this.$input_password.attr("tabindex",3).attr("autocomplete","off"),this.$submit_btn.attr("tabindex",4).attr("autocomplete","off")):"signin"===b?(this.$el.toggleClass("signin",!0).toggleClass("signup",!1).toggleClass("emailconfirm",!1),this.$input_email.attr("tabindex",1).attr("autocomplete","on"),this.$input_name.removeAttr("tabindex").attr("autocomplete","on"),this.$input_password.attr("tabindex",2).attr("autocomplete","on"),this.$submit_btn.attr("tabindex",3).attr("autocomplete","on")):"emailconfirm"===b&&(this.$el.toggleClass("signin",!1).toggleClass("signup",!1).toggleClass("emailconfirm",!0),this.$input_email.attr("tabindex",1).attr("autocomplete","off"),this.$input_name.removeAttr("tabindex").attr("autocomplete","off"),this.$input_password.removeAttr("tabindex").attr("autocomplete","off"),this.$submit_btn.removeAttr("tabindex").attr("autocomplete","off")),!1},submitForm:function(){return this.$form.submit(),!1},submit:function(a){a.preventDefault(),a.stopPropagation();var b=$.trim(this.$input_email.val()),c=$.trim(this.$input_name.val()),d=$.trim(this.$input_password.val());return"signin"===this.model.get("state")?_.isEmail(b)?b.length>50?this.showError(jhst.localize("Too much","auth"),"email"):_.isEmpty(d)?this.showError(jhst.localize("Do you have an empty password?","auth"),"password"):d.length>45?this.showError(jhst.localize("Too much","auth"),"password"):this.model.signin.login({login:b,password:d}):this.showError(jhst.localize("Doesn&#39;t look like a valid email","auth"),"email"):"signup"===this.model.get("state")?_.isEmail(b)?b.length>50?this.showError(jhst.localize("Too much","auth"),"email"):_.isEmpty(c)?this.showError(jhst.localize("Please enter your name","auth"),"name"):c.length>55?this.showError(jhst.localize("Too much","auth"),"name"):_.isEmpty(d)?this.showError(jhst.localize("Please use not an empty password","auth"),"password"):d.length>45?this.showError(jhst.localize("Too much","auth"),"password"):this.model.registration.fetch({login:b,password:d,name:c}):this.showError(jhst.localize("Doesn&#39;t look like a valid email","auth"),"email"):"emailconfirm"===this.model.get("state")&&(_.isEmail(b)?b.length>50?this.showError(jhst.localize("Too much","auth"),"email"):this.model.emailconfirm.fetch({email:b}):this.showError(jhst.localize("Doesn&#39;t look like a valid email","auth"),"email")),!1},errorSignin:function(a){401===a.status?this.showError(jhst.localize("Wrong e-mail and password combination :(","auth"),"email"):this.showError(jhst.localize("Something went wrong...","misc"),"email")},errorSignup:function(a){401===a.status?this.showError(jhst.localize("Wrong e-mail and password combination :(","auth"),"email"):this.showError(jhst.localize("Something went wrong...","misc"),"email")},errorEmail:function(a){401===a.status?this.showError(jhst.localize("Doesn&#39;t look like a valid email","auth"),"email"):this.showError(jhst.localize("Something went wrong...","misc"),"email")},showError:function(a,b){switch(this.$error.html(a),this.$el.toggleClass("error",!0),b){case"email":this.$input_email.parents(".jhst__inp-cont").toggleClass("error-inp",!0),this.$input_email.focus();break;case"name":this.$input_name.parents(".jhst__inp-cont").toggleClass("error-inp",!0),this.$input_name.focus();break;case"password":this.$input_password.parents(".jhst__inp-cont").toggleClass("error-inp",!0),this.$input_password.focus()}},hideErrors:function(){this.$el.toggleClass("error",!1),this.$el.find(".error-inp").toggleClass("error-inp",!1)},clear:function(){this.hideErrors(),this.$input_email.val(""),this.$input_name.val(""),this.$input_password.val("")},loginFB:function(a){return this.model.FB.login(a),!1},loginTW:function(a){return this.model.TW.login(a),!1},loginVK:function(a){return this.model.VK.login(a),!1},remove:function(a){return this.model.off(null,null,this),this.model.signin.off(null,null,this),this.model.registration.off(null,null,this),this.model.emailconfirm.off(null,null,this),this.popup_view.unlockPage(),this.popup_view.remove(),delete this.popup_view,Backbone.View.prototype.remove.call(this,a)}}),jhst.Auth=Backbone.Model.extend({vk_user_obj:{},defaults:{state:""},initialize:function(){this.FB=new jhst.FB,this.VK=new jhst.VK,this.signin=new jhst.Signin,this.registration=new jhst.Registration,this.emailconfirm=new jhst.EmailConfirm,this.on("vkontakte:hi",function(a){this.VK.fetch(a)},this),this.FB.on("auth:success",this.authSuccess,this),this.VK.on("auth:success",this.checkVKEmail,this),this.signin.on("auth:success",this.authSuccess,this),this.registration.on("auth:success",this.authSuccess,this),this.emailconfirm.on("auth:success",this.authSuccess,this),this.registration.on("auth:success",this.authSuccess,this),this.registration.on("registration:success",this.afterRegistration,this),this.FB.on("error",this.error,this),this.VK.on("error",this.error,this),this.signin.on("error",this.error,this),this.registration.on("error",this.error,this),this.registration.on("registration:success",function(){jhst.navigate("/",{trigger:!0})},this),jhst.on("auth:show",function(a){return console.log("auth:show"),jhst.is_authed()?(jhst.navigate("/",{trigger:!0}),!1):(this.set("state","signup"),this.view=new jhst.AuthView({model:this}),void this.trigger("auth:show",a))},this),jhst.on("navbar:logout",function(){this.logout()},this)},authSuccess:function(a){a.session&&this.trigger("auth:success",a)},checkVKEmail:function(a){a.user&&a.user.email&&-1!==a.user.email.indexOf("@vk.com")?(this.set("state","emailconfirm"),this.emailconfirm.set({user_obj:a})):this.authSuccess(a)},afterRegistration:function(){jhst.app.statistic.trackRegistration()},logout:function(){this.trigger("auth:clear")},error:function(a){this.trigger("error",a)}}),jhst.Config=function(){return{}},jhst.Statistic=Backbone.Model.extend({yaCounter:null,gaCounter:null,initialize:function(){this.active=!_.browser.phantom},trackCurrentPageChange:function(){return this.active?(this.trackPageChange(window.location.pathname),!0):!1},trackPageChange:function(a){if(!this.active)return!1;var b=a.toString();"/"!=b.charAt(0)&&(b="/"+b),window._gaq&&window._gaq.push(["_trackPageview",b]),window.yaCounter22431070&&window.yaCounter22431070.hit(jhst.root+b)},trackRegistration:function(){return this.active?(window._gaq.push(["_trackEvent","User","registration"]),void window.yaCounter22431070.reachGoal("User_registration")):!1},trackProductCreate:function(a){return this.active?(a||(a="unnamed"),window._gaq.push(["_trackEvent","Product","create",a]),void window.yaCounter22431070.reachGoal("Product_create")):!1},trackPSConnect:function(a){return this.active?(a||(a="unnamed"),window._gaq.push(["_trackEvent","PaySystem","connect",a]),void window.yaCounter22431070.reachGoal("PaySystem_connect")):!1},trackProductTryToBuy:function(a){return this.active?(a||(a="unnamed"),window._gaq.push(["_trackEvent","Product","trytobuy",a]),void window.yaCounter22431070.reachGoal("Product_trytobuybuy")):!1},trackFeedback:function(a){return this.active?(a||(a="unnamed"),window._gaq.push(["_trackEvent","Feedback","send",a]),void window.yaCounter22431070.reachGoal("Feedback_send")):!1},trackOpenBusinessFeedback:function(a){return this.active?(a||(a="unnamed"),window._gaq.push(["_trackEvent","BusinessFeedback","open",a]),void window.yaCounter22431070.reachGoal("BusinessFeedback_open")):!1},trackBusinessFeedback:function(a){return this.active?(a||(a="unnamed"),window._gaq.push(["_trackEvent","BusinessFeedback","send",a]),void window.yaCounter22431070.reachGoal("BusinessFeedback_send")):!1},trackProductSold:function(a){return this.active?(a||(a="unnamed"),window._gaq.push(["_trackEvent","Product","sold",a]),void window.yaCounter22431070.reachGoal("Product_sold")):!1}}),jhst.App=Backbone.Model.extend({_didScroll:!1,initialize:function(){this.$og_image=$("#og_image"),this.$og_url=$("#og_url");var a=this,b=window.jhst;this.config=new b.Config,this.statistic=new b.Statistic,this.router=new b.Router,this.pages=new b.PagesCollection,this.user=new b.User,b.user=this.user,this.auth=new b.Auth,b.config=this.config,this.pages.add(new b.Page({name:"404",template:"pages/404-page"})),this.pages.add(new b.Page({name:"403",template:"pages/403-page"})),this.landing=new b.LandingPage({name:"landing",template:"pages/landing-page"}),this.pages.add(this.landing),this.router.on("404",function(){a.pages.getPage("404").render()}),this.router.on("route",function(a,c,d){switch(console.log("route:"+a),this.router.route_passed>1&&this.statistic.trackCurrentPageChange(),b.trigger("route",a,c,d),a){case"er404":this.pages.getPage("404").render();break;case"er403":this.pages.getPage("403").render();break;case"landing":b.is_authed()?b.navigate("/items",{trigger:!0}):this.landing.render({section:0});break;default:c[0]&&!this.router.previousWasPopup()}this.trigger("need:meta:update")},this),this.router.on("reset",function(a,c){if(console.log(a,c),!this.router.isPopup(c))switch(this.router.isPopup(a)||b.speedScrollTop(0,1),a){case"landing":console.log("reset:landing"),this.landing.sleep()}this.router.isPopup(a)&&_.forEach(this.pages.models,function(a){a.sleep&&a.get("name")!=c&&a.sleep()})},this),this.on("need:meta:update",function(){this.$og_url.attr("content",window.location.href)},this),b.on("historyback",function(){b.navigate(this.router.back_path,{trigger:!0})},this),b.on("historyback:reload",function(){b.trigger("historyback"),window.location.reload()},this),b.on("auth:clear",function(){b.navigate("/logout",{trigger:!0})}),b.on("link:delete",function(){b.navigate("/items",{trigger:!0})}),b.on("feedback:show",function(a){if(a=a||{},b.is_authed()){var c=b.user.settings.toJSON();a=_.extend({email:c.email,name:c.name},a)}return new b.Feedback(a),!0}),this.on("twitter:hi",function(a){this.auth.trigger("twitter:hi",a)},this),this.on("vkontakte:hi",function(a){this.auth.trigger("vkontakte:hi",a)},this),this.on("error",function(a){console.error("error"),a&&a.description&&b.error(a.description)}),this.auth.on("auth:success",function(a){b.trigger("auth:success",a),console.log(this.router.current_route),"profile"===this.router.current_route||"landing"!==this.router.current_route&&""!==this.router.current_route||b.navigate("/items",{trigger:!0})},this),this.auth.on("auth:clear",function(){b.trigger("auth:clear")},this);var c=$(window),d=$(document);$(window).scroll(function(){var a=c.scrollTop(),e=d.height(),f=c.height();b.trigger("scroll",{s_top:a,d_h:e,w_h:f}),a+150>=e-f&&b.trigger("pagebottom:reached")}),!b.is_authed(),b.trigger("app:init")}}),jhst.Router=Backbone.Router.extend({_previous_route:"",previous_route:"",previous_page_route:"",current_route:"",_back_path:"",back_path:"",route_passed:0,context:{},routes:{"":"landing","/":"landing",".":"landing","/unlimited/":"landing",404:"er404",403:"er403","*default":"er404"},popoup_routes:["auth"],logout:function(){localStorage.clear(),this.navigate("/"),window.location.reload()},er404:function(){return console.log("no such route ",arguments),this.trigger("404",arguments),!1},er403:function(){return console.log("access dinied route ",arguments),this.trigger("403",arguments),!1},initialize:function(){var a=_.uniq(_.values(this.routes));_(a).each(function(a){this.on("route:"+a,function(){this.route_passed++,this._previous_route&&this._previous_route!=a&&(this.trigger("reset",this._previous_route,a,this._back_path),this.trigger("reset:"+this._previous_route)),this._previous_route=a,this._back_path=Backbone.history.fragment},this)},this),this.on("reset",function(a,b,c){this.back_path=c,this.current_route=b,this.previous_route=a,this.isPopup(this.previous_route)||(this.previous_page_route=this.previous_route)})},previousWasPopup:function(){return this.isPopup(this.previous_route)},currentIsPopup:function(){return this.isPopup(this.current_route)},isPopup:function(a){return-1!==_.indexOf(this.popoup_routes,a)}}),jhst.LandingPage=jhst.Page.extend({visited:!1,defaults:{img_num:0,lang:"en"},initialize:function(a){this.set("lang",jhst.language),a=a||{}},render:function(a){this.set(a),this.visited?this.view.render():(this.visited=!0,this.view=new jhst.LandingPageView({model:this,template:"pages/landing-page"}),this.view.render())},showAuth:function(){jhst.trigger("auth:show")},sleep:function(){this.view&&this.view.sleep()}}),jhst.LandingPageView=jhst.PageView.extend({indent:60,$window:$(window),events:{"click .landing__start-a":"showAuth","click .landing__next-a":"goSection2"},render:function(){if(this.renderedHtml)this.$el.append(this.renderedHtml);else{var a=$("<div></div>").addClass("page-"+this.model.get("name")).html(this.template(this.model.toJSON()));this.trigger("page:preRender",a),this.$el.html(a)}$("body").attr("class","body__page-"+this.model.get("name")),this.model.enterDocument(),this.trigger("page:render",this.model),this.trigger("enterDocument",this.model),this.$window.on("resize.landing.page",_.bind(this.repositionPage,this)),this.$sec1=this.$el.find(".landing-section1"),this.$sec2=this.$el.find(".landing-section2"),this.$sec3=this.$el.find(".landing-section3"),this.repositionPage(),this.$nav_how=$(".navbar__item-how>a"),this.$nav_where=$(".navbar__item-where>a"),this.$nav_how.on("click.landing",_.bind(this.goSection2,this)),this.$nav_where.on("click.landing",_.bind(this.goSection3,this)),this.delegateEvents(),0!==this.model.get("section")&&(2===this.model.get("section")?this.goSection2():3===this.model.get("section")&&this.goSection3())},repositionPage:function(){{var a=0;$(window).width()}a=this.$window.innerHeight()-this.indent;var b=Math.max(a,600);this.$sec1.height(b),this.$sec2.css({"margin-top":b})},showAuth:function(){return this.model.showAuth(),!1},goSection2:function(){return $("html, body").animate({scrollTop:this.$sec2.offset().top-this.indent},780),!1},goSection3:function(){return $("html, body").animate({scrollTop:this.$sec3.offset().top-this.indent},780),!1},sleep:function(){this.$nav_how.off("click.landing"),this.$nav_where.off("click.landing"),this.$window.off("resize.landing.page"),this.undelegateEvents()}}),jhst=jhst||{},jhst.l10n=jhst.l10n||{},jhst.l10n.plural={processors:{en:function(a,b){var c=_.toJSON(b.toString());return 1==a?c[0]:c[1]},ru:function(a,b){var c=_.toJSON(b.toString());return a%10==1&&a%100!=11?c[0]:a%10>=2&&4>=a%10&&(10>a%100||a%100>=20)?c[1]:c[2]},ko:function(a,b){var c=_.toJSON(b.toString());return c[0]},ja:function(a,b){var c=_.toJSON(b.toString());return c[0]},zh:function(a,b){var c=_.toJSON(b.toString());return c[0]}},item:{en:'["pricetag", "pricetag"]',ru:'["ценник", "ценника", "ценников"]'}},jhst=jhst||{},jhst.l10n=jhst.l10n||{},jhst.l10n.auth={"Enter your e-mail":{en:"Enter your e-mail",ru:"Введите свой e-mail"},"Social log in":{en:"Social log in",ru:"Войти через социальные сети"},"Log in":{en:"Log in",ru:"Вход"},Facebook:{en:"Facebook",ru:"Фейсбук"},Twitter:{en:"Twitter",ru:"Twitter"},VKontakte:{en:"VKontakte",ru:"ВКонтакте"},or:{en:"or",ru:"или"},"sign up":{en:"sign up",ru:"зарегистрироваться"},"log in by e-mail":{en:"log in by e-mail",ru:"войти по e-mail"},"Log in by e-mail":{en:"Log in by e-mail",ru:"Войти по e-mail"},'I admit <a href="/i/user-agreement/">user agreement</a>':{en:'I admit <a href="/i/user-agreement/" target="_blank">user agreement</a>',ru:'Регистрируясь, вы принимаете условия  <a  href="/i/user-agreement/" target="_blank">пользовательского соглашения</a>'},"Sign up":{en:"Sign up",ru:"Зарегистрироваться"},"Log in":{en:"Log in",ru:"Войти"},"e-mail":{en:"e-mail",ru:"e-mail",ko:"이메일",ja:"メールアドレス",zh:"电子邮箱"},password:{en:"password",ru:"пароль",ko:"비밀번호",ja:"パスワード",zh:"密码"},name:{en:"name",ru:"имя"},"Doesn&#39;t look like a valid email":{en:"Doesn&#39;t look like a valid e-mail",ru:"Неправильный формат e-mail"},"Please use not an empty password":{en:"Please use not an empty password",ru:"Пожалуйста введите пароль"},"Do you have an empty password?":{en:"Do you have an empty password?",ru:"У Вас что пустой пароль?"},"Too much":{en:"Too much",ru:"Что-то недопустимо большое"},"Please enter your name":{en:"Please enter your name",ru:"Введите имя"},"Wrong e-mail and password combination :(":{en:"Wrong e-mail and password combination :(",ru:"Неверный e-mail или пароль"}},jhst=jhst||{},jhst.l10n=jhst.l10n||{},jhst.l10n.warning={"Warning!":{en:"Warning!",ru:"Предупреждение!",ko:"경고!",ja:"ご注意！",zh:"警告！"},Ok:{en:"Ok",ru:"Ок",ko:"오케이",ja:"OK",zh:"确定"}},jhst=jhst||{},jhst.l10n=jhst.l10n||{},jhst.l10n.p404={"Make sure that URL entered correctly;":{en:"Make sure that URL entered correctly;",ru:"Убедитесь, что ссылка введена правильно;",ko:"URL을 정확히 입력하세요;",ja:"正確にURLが入力されたか確認して下さい",zh:"请输入正确的URL"},'or drop us a line to <a href="mailto:support@jhstoq.me" class="lnk">support@jhstoq.me.</a>':{en:'or drop us a line to <a href="mailto:support@jhstoq.me" target="mail" class="lnk">support@jhstoq.me.</a>',ru:'Или напишите нам — <a href="mailto:support@jhstoq.me" target="mail" class="lnk">support@jhstoq.me</a>',ko:'또는 여기로 메시지를 보내주세요 <a href="mailto:support@jhstoq.me" target="mail" class="lnk">support@jhstoq.me</a>',ja:'もしくは<a href="mailto:support@jhstoq.me" target="mail" class="lnk">support@jhstoq.me.</a>にメッセージを送信して下さい。',zh:'或者给我们写信 <a href="mailto:support@jhstoq.me" target="mail" class="lnk">support@jhstoq.me.</a>'}},jhst=jhst||{},jhst.l10n=jhst.l10n||{},jhst.l10n.p403={phr001:{en:"Sorry, can’t let you get any further than this.",ru:"Мы сейчас не можем показать вам эту страницу."}},jhst=jhst||{},jhst.l10n=jhst.l10n||{},jhst.l10n.landing_page={"Get payments online<br/>for what ever and where ever you want":{en:"Get payments online<br/>for what ever and where ever you want",ru:"Принимайте платежи онлайн<br/>за что угодно и любым способом"},"section1-p":{en:"Justhost — it is a platform for creating price tags<br/>and getting payments for your digital content or real<br/>goods and servicies",ru:"Justhost — это сервис для создания виртуальных ценников<br/>и приема платежей за ваш контент или реальные<br/>товары и услуги"},"section3-p":{en:"Sale of an access to a file, a link, a text, a webinar, every digital content or get payment<br/>for goods and services by a huge amount of ecurrencies and by all types of <br/>plastic cards",ru:"Продать доступ к файлу, ссылке, тексту, вебинару, любому цифровому контенту или принять <br/>оплату за товары и услуги большинством видов электронных валют и всеми видами <br/>пластиковых карт"},Start:{en:"Start Justhost",ru:"Начать продавать c Justhost"},"Pricetag example":{en:"Pricetag and purchase<br/>example",ru:"Пример ценника<br/>и оплаты"},"Start Justhost":{en:"Start Justhost",ru:"Начать продавать c Justhost"},"How does it work":{en:"How does it work",ru:"Как это работает"},"How does Justhost work":{en:"How payments can be received with Justhost",ru:"Как принимать оплату с Justhost"},"Connect your payment systems":{en:"Connect your payment systems",ru:"Подключите ваши платежные системы"},"section2-0-1-p":{en:"In your account settings add payment systems you want to deal with. Money will go to your account in these systems.",ru:"В личном кабинете добавьте платежные системы с которыми вы хотите принимать оплату. Деньги от покупателей будут приходить сразу на ваши счета в этих системах."},"Create a price tag":{en:"Create a price tag",ru:"Создайте ценник товара или услуги"},"section2-1-1-p":{en:"Upload file or set a link. Add a title, a description, a photo and a preview, set a price&nbsp;-&nbsp;as easy as pie!",ru:"Загрузите файл или добавьте ссылку на контент. Добавьте название, описание, фотографию или обложку, установите цену&nbsp;-&nbsp;проще некуда!"},"Publish the link":{en:"Publish the link",ru:"Опубликуйте ссылку"},"section2-2-1-p":{en:"Get the price tag link, share it, stick it, distribute it, send it to your audience. By clicking on this link the customers will open the price tag",ru:"Получите ссылку на ваш ценник и размещайте в социальных сетях, на сайтах, в блогах, расшаривайте, раздавайте, рассылайте ссылки вашей аудитории. Кликая по этой ссылке, покупатели откроют окно ценника и оплаты."},"Get payments in any cases":{en:"Get payments in any cases",ru:"Принимайте оплату в любых ситуациях"},Donate:{en:"Donation",ru:"Пожертвования"},"section3-1-1-p":{en:"You can place the widget or the link.",ru:"Вы размещаете виджет или ссылку, кликнув по которой пользователи могут перевести вам любую сумму"},"Payments for digital content":{en:"Payments for digital content",ru:"Оплата за цифровой контент"},"section3-2-1-p":{en:"Place the link to make access to your payment content. After the payment the customer will get a file or a content link",ru:"Размещайте ссылку для оплаты доступа к любому контенту. После оплаты покупатель получает файл или ссылку"},"Selling reallife goods":{en:"Selling reallife goods",ru:"Продажа реальных товаров"},"section3-3-1-p":{en:"You create product item, set a price and contribute a link for purchase on your site, in social medias or on your blog",ru:"Вы создаете карточку продукта, задаете цену и размещаете ссылку для оплаты на своем сайте, в социальных сетях или в блоге"},"Freelance and services":{en:"Freelance and services",ru:"Фриланс и услуги"},"section3-4-1-p":{en:"User follows your link and pays your price. In your profile you will see emails of your customers",ru:"Пользователь переходит по вашей ссылке и оплачивает установленную вами сумму. В личном кабинете вы увидите email покупателя"},"Freelance and services":{en:"Freelance and services",ru:"Фриланс и услуги"},"section3-4-1-p":{en:"User follows your link and pays your price. In your profile you will see emails of your customers",ru:"Пользователь переходит по вашей ссылке и оплачивает установленную вами сумму. В личном кабинете вы увидите email покупателя"},"Group buying":{en:"Group buying",ru:"Коллективные покупки"},"section3-5-1-p":{en:"User follows your link and pays your price. In your profile you will see emails of your customers",ru:"Пользователь переходит по вашей ссылке и оплачивает установленную вами сумму. В личном кабинете вы увидите email покупателя"},Charity:{en:"Charity",ru:"Благотворительность"},"section3-6-1-p":{en:"You can place the widget or the link.",ru:"Вы размещаете виджет или ссылку, кликнув по которой пользователи могут перевести вам любую сумму"},"E-learning and consultations":{en:"E-learning and consultations",ru:"Онлайн-обучение и&nbsp;консультации"},"section3-7-1-p":{en:"User follows your link and pays your price. In your profile you will see emails of your customers",ru:"Пользователь переходит по вашей ссылке и оплачивает установленную вами сумму. В личном кабинете вы увидите email покупателя"},"And much more":{en:"And much more",ru:"И еще много разного"},"section3-8-1-p":{en:"And much much much much much much much much much much much much more. It's up to you",ru:"И еще много, много, много, много, много, много, много, много, много чего еще"},Fast:{en:"Fast",ru:"Быстро"},"section4-1-1-p":{en:"No programing, but only comfortable interface",ru:"Никакого программирования, только удобный интерфейс"},Cozy:{en:"Cozy",ru:"Удобно"},"section4-2-1-p":{en:"All info about your sells - who? when? how many and how much?",ru:"Вся информация о ваших продажах: кто, когда, сколько купил и оплатил"},Free:{en:"Free",ru:"Бесплатно"},"section4-3-1-p":{en:"All Justhost service absolutely free till the middle of 2014",ru:"Все сервисы Justhost абсолютно бесплатны до середины 2014"}};